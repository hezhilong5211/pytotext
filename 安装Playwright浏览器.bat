@echo off
chcp 65001 >nul
color 0A

echo.
echo ================================================================================
echo                    链接提取工具 - Playwright浏览器安装
echo ================================================================================
echo.
echo 本工具需要Playwright浏览器支持（约300MB）
echo 安装过程需要2-5分钟，请保持网络连接
echo.
echo ================================================================================
echo.

pause

echo.
echo [1/2] 正在安装Playwright浏览器...
echo.

playwright install chromium

if %errorlevel% equ 0 (
    echo.
    echo ================================================================================
    echo [2/2] ✅ 安装成功！
    echo ================================================================================
    echo.
    echo 现在可以打开【链接提取工具.exe】使用了
    echo.
    echo 支持的网站包括：
    echo   ✅ 今日头条
    echo   ✅ 百度百家号
    echo   ✅ 抖音
    echo   ✅ 微博
    echo   ✅ 小红书
    echo   ✅ 汽车之家
    echo   ✅ 买车网
    echo   ✅ 其他大部分网站
    echo.
    goto end
) else (
    echo.
    echo ================================================================================
    echo [2/2] ❌ 安装失败
    echo ================================================================================
    echo.
    echo 可能的原因：
    echo   1. 网络连接不稳定
    echo   2. 防火墙阻止下载
    echo   3. 磁盘空间不足（需要至少500MB）
    echo.
    echo 解决方法：
    echo   1. 检查网络连接
    echo   2. 关闭防火墙或代理
    echo   3. 清理磁盘空间
    echo   4. 重新运行本安装脚本
    echo.
    echo 如果多次失败，请尝试手动安装：
    echo   打开命令行，运行: python -m playwright install chromium
    echo.
    goto end
)

:end
echo ================================================================================
echo.
pause

